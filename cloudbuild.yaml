steps:
  - name: 'gcr.io/cloud-builders/git'
    id: fetch_full_repository
    entrypoint: 'bash'
    args:
      - -c
      - |
        cd /dev-files/
        git clone https://github.com/Bluebird-Parking/bluebird-parking-seed.git
        cd bluebird-parking-seed
        git checkout $BRANCH_NAME
    volumes:
      - name: 'dev-files'
        path: /dev-files
  - name: 'gcr.io/cloud-builders/npm'
    id: commitlint
    entrypoint: 'bash'
    args:
      - -c
      - |
        cd /dev-files/bluebird-parking-seed/
        git status
        npm install
        npx commitlint --from HEAD~1 --to HEAD --verbose
    volumes:
      - name: 'dev-files'
        path: /dev-files
  - name: 'gcr.io/cloud-builders/npm'
    id: npm_install
    args:
      - install
  - name: 'gcr.io/cloud-builders/npm'
    id: npm_run_build
    args:
      - run
      - build
  - name: 'gcr.io/cloud-builders/npm'
    id: npm_run_lint
    args:
      - run
      - lint
  - name: 'gcr.io/cloud-builders/npm'
    id: npm_run_test
    args:
      - run
      - test
